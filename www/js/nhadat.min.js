var App=angular.module("App","ngAnimate ngTouch ngSanitize ngRoute App.filters App.services App.directives App.controllers ui.bootstrap google-maps".split(" ")).value("version","\u00a9 2001-2014 nhadat.com").value("Domain","http://127.0.0.1").config(["$routeProvider","$locationProvider","$httpProvider",function(a,b,d){a.when("/login.html",{templateUrl:"html/login.html"});a.when("/update.html",{templateUrl:"html/update.html"});a.when("/newpassword.html",{templateUrl:"html/newpassword.html"});a.when("/account.html",
{templateUrl:"html/account.html"});a.when("/diadanh.html",{templateUrl:"html/group.html"});a.when("/agent.html",{templateUrl:"html/agent.html"});a.when("/search.html",{templateUrl:"html/search.html"});a.when("/t/:tagId",{templateUrl:"html/tag.html"});a.when("/p/:postId*",{templateUrl:"html/post.html"});a.when("/c/:commentId*",{templateUrl:"html/comment.html"});a.when("/profile/:profileId",{templateUrl:"html/profile.html"});a.when("/map/:mapId*",{templateUrl:"html/map.html"});a.when("/contact/:contactId",
{templateUrl:"html/contact.html"});a.when("/sale.html",{templateUrl:"html/sale.html"});a.when("/share.html",{templateUrl:"html/share.html"});a.when("/",{templateUrl:"html/welcome.html",controller:"WelcomeCtrl"});a.otherwise({redirectTo:"/"});b.html5Mode(!1);d.defaults.headers.common={"X-Requested-With":"XMLHttpRequest"}}]).config(["$httpProvider",function(a){a.responseInterceptors.push(["$location","$q","Session","Flash",function(a,d,c,e){var f=function(a){return a},g=function(f){401===f.status&&
(c.unset("authenticated"),a.path("/login.html"),e.show({type:"error",msg:f.data.flash}));return d.reject(f)};return function(a){return a.then(f,g)}}])}]).config(["$compileProvider",function(a){a.aHrefSanitizationWhitelist(/^\s*(https?|mailto|tel|sms|file):/)}]).run(["$rootScope","$location","Auth","Flash",function(a,b,d,c){var e=["/diadanh.html","/sale.html","/share.html","/update.html","/account.html"],f=["/diadanh.html","/sale.html"];a.isPath="";a.$on("$routeChangeStart",function(g,h,k){a.isLogin=
d.isLoggedIn();a.User=d.user();a.isMenu=!1;_(e).contains(b.path())&&!a.isLogin&&(a.isPath=b.path(),b.path("/login.html"),c.show({type:"info",msg:"M\u1ee5c n\u00e0y c\u1ea7n ph\u1ea3i \u0111\u0103ng nh\u1eadp \u0111\u1ec3 ti\u1ebfp t\u1ee5c."}));!_(f).contains(b.path())||a.User.phone&&a.User.first_name||(b.path("/update.html"),c.show({type:"info",msg:"\u0110\u1ec3 rao \u0111\u0103ng b\u1ea1n c\u1ea7n ph\u1ea3i c\u1eadp nh\u1eadp t\u00ean v\u00e0 s\u1ed1 \u0111i\u1ec7n tho\u1ea1i."}))})}]),services=
angular.module("App.services",[]).factory("SearchService",["$http","Domain",function(a,b){var d=function(a){this.items=[];this.busy=!1;this.page=1;this.end=!1;this.search=a||[];this.nextPage()};d.prototype.nextPage=function(){this.end||this.busy||(this.busy=!0,this.end||a.post(b+"/api/search",{page:this.page,retina:window.devicePixelRatio,search:this.search}).success(function(a){if(0<a.length){for(var b=0;b<a.length;b++)this.items.push(a[b]);this.page++}else this.end=!0;this.busy=!1}.bind(this)))};
return d}]).factory("TagService",["$http","Domain",function(a,b){var d=function(a){this.items=[];this.busy=!1;this.page=1;this.end=!1;this.search=a||"";this.nextPage()};d.prototype.nextPage=function(){this.end||this.busy||(this.busy=!0,!this.end&&this.search.length&&a.post(b+"/api/search/tag",{page:this.page,retina:window.devicePixelRatio,keyword:this.search}).success(function(a){if(0<a.length){for(var b=0;b<a.length;b++)this.items.push(a[b]);this.page++}else this.end=!0;this.busy=!1}.bind(this)))};
return d}]).factory("Flash",["$rootScope","$timeout",function(a,b){return{show:function(d){a.flash=d;b(function(){a.flash=""},9E4)},clear:function(){a.flash=""}}}]).factory("Session",function(){return{get:function(a){return localStorage.getItem(a)},set:function(a,b){return localStorage.setItem(a,b)},unset:function(a){return localStorage.removeItem(a)}}}).factory("Auth",["$http","$sanitize","Session","Flash","Domain",function(a,b,d,c,e){var f=function(a){return{user:b(a.user),password:b(a.password)}};
return{login:function(b){return a.post(e+"/api/user/login",f(b)).success(function(a){d.set("user",JSON.stringify(a.user));c.show({type:"success",msg:a.flash})}).error(function(a){c.show({type:"danger",msg:a.flash})})},logout:function(){return a.get(e+"/api/user/logout").success(function(){d.unset("user");c.show({type:"success",msg:"B\u1ea1n \u0111\u00e3 tho\u00e1t ra an to\u00e0n."})})},update:function(a){d.set("user",JSON.stringify(a))},user:function(){return JSON.parse(d.get("user"))},sendmail:function(b){return a.post(e+
"/api/user/sendmail",f(b)).success(function(a){c.show({type:"success",msg:a.flash})}).error(function(a){c.show({type:"danger",msg:a.flash})})},guest:function(){return a.get(e+"/api/user/guest").success(function(a){d.set("guest",a.user)})},isGuest:function(){return d.get("guest")},isLoggedIn:function(){return d.get("user")}}}]);
angular.module("App.directives",[]).directive("appVersion",["version",function(a){return function(b,d,c){d.text(a)}}]).directive("scrolltop",function(){return{restrict:"EM",template:'<a href="#" class="scroll-top"><i class="icon-chevron-up"></i></a>'}}).directive("mainnav",["$location","$rootScope","Auth",function(a,b,d){return{restrict:"EM",templateUrl:"html/nav.html",controller:["$scope","$element","$attrs",function(b,e,f){b.logout=function(){d.logout().success(function(){b.isLogin=!1;a.path("/")})};
b.navClass=function(b){var c=a.path().substring(1)||"";return b===c?"active":""}}]}}]).directive("slider",function(){return{restrict:"EM",templateUrl:"html/slider.html"}}).directive("comments",function(){return{restrict:"E",templateUrl:"html/comments.html"}}).directive("agent",function(){return{restrict:"EM",templateUrl:"html/agents.html"}}).directive("notice",function(){return{restrict:"EM",templateUrl:"html/notice.html"}}).directive("classifieds",function(){return{restrict:"EM",templateUrl:"html/classifieds.html"}}).directive("follows",
function(){return{restrict:"EM",templateUrl:"html/follows.html"}}).directive("flash",function(){return{restrict:"EM",templateUrl:"html/flash.html"}}).directive("mainpage",["$rootScope",function(a){return{restrict:"EM",template:'<div id="mainpage" ng-view ng-click="isMenu = false"></div>'}}]).directive("infiniteScroll",["$rootScope","$window","$timeout",function(a,b,d){return{link:function(c,e,f){var g,h,k,l;b=angular.element(b);k=0;null!=f.infiniteScrollDistance&&c.$watch(f.infiniteScrollDistance,
function(a){return k=parseInt(a,10)});l=!0;g=!1;null!=f.infiniteScrollDisabled&&c.$watch(f.infiniteScrollDisabled,function(a){if((l=!a)&&g)return g=!1,h()});h=function(){var d;d=b.height()+b.scrollTop();if((d=e.offset().top+e.height()-d<=b.height()*k)&&l)return a.$$phase?c.$eval(f.infiniteScroll):c.$apply(f.infiniteScroll);if(d)return g=!0};b.on("scroll",h);c.$on("$destroy",function(){return b.off("scroll",h)});return d(function(){if(f.infiniteScrollImmediateCheck){if(c.$eval(f.infiniteScrollImmediateCheck))return h()}else return h()},
0)}}}]).directive("goClick",["$location",function(a){return function(b,d,c){var e;c.$observe("goClick",function(a){e=a});d.bind("click",function(){b.$apply(function(){a.path(e)})})}}]).directive("remove",["$http","$location","Domain",function(a,b,d){return function(c,e,f){e.bind("click",function(){confirm("B\u1ea1n ch\u1eafc ch\u1eafn mu\u1ed1n x\u00f3a tin n\u00e0y?")&&a.post(d+"/api/message/destroy",{id:f.remove}).success(function(a){alert("\u0110\u00e3 x\u00f3a th\u00e0nh c\u00f4ng.");c.$apply(function(){b.path("/index.html")})}).error(function(a,
b){403===b&&alert("B\u1ea1n ph\u1ea3i \u0111\u0103ng nh\u1eadp \u0111\u1ec3 s\u1eed d\u1ee5ng ch\u1ee9c n\u0103ng n\u00e0y.");404===b&&alert("N\u1ed9i dung kh\u00f4ng t\u00ecm th\u1ea5y, x\u00f3a tin th\u1ea5t b\u1ea1i.")})})}}]).directive("report",["$http","Domain",function(a,b){return function(a,b,e){b.bind("click",function(){alert("C\u00e1m \u01a1n b\u1ea1n \u0111\u00e3 b\u00e1o tin.")})}}]).directive("like",["$http","Domain",function(a,b){return function(d,c,e){c.bind("click",function(){a.post(b+
"/api/like/create",{like:e.like}).success(function(a){a.like?c.html('<a class="active"><i class="icon-thumbs-up"></i></a> '+a.total):c.html('<a><i class="icon-thumbs-up"></i></a> '+a.total)}).error(function(a,b){403===b&&alert("B\u1ea1n ph\u1ea3i \u0111\u0103ng nh\u1eadp \u0111\u1ec3 s\u1eed d\u1ee5ng ch\u1ee9c n\u0103ng n\u00e0y.")})})}}]).directive("follow",["$http","Domain",function(a,b){return function(d,c,e){c.bind("click",function(){a.post(b+"/api/follow/create",{follow:e.follow}).success(function(a){c.html('<a class="active"><i class="icon-thumbs-up"></i></a> '+
a.total+" theo d\u00f5i")}).error(function(a,b){403===b&&alert("B\u1ea1n ph\u1ea3i \u0111\u0103ng nh\u1eadp \u0111\u1ec3 s\u1eed d\u1ee5ng ch\u1ee9c n\u0103ng n\u00e0y.")})})}}]).directive("autoGrow",function(){return function(a,b,d){var c=b[0].offsetHeight;a=b.css("paddingLeft");d=b.css("paddingRight");var e=angular.element("<div></div>").css({position:"absolute",top:-1E4,left:-1E4,width:b[0].offsetWidth-parseInt(a||0)-parseInt(d||0),fontSize:b.css("fontSize"),fontFamily:b.css("fontFamily"),lineHeight:b.css("lineHeight"),
resize:"none"});angular.element(document.body).append(e);a=function(){var a=b.val().replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/&/g,"&amp;").replace(/\n$/,"<br/>&nbsp;").replace(/\n/g,"<br/>").replace(/\s{2,}/g,function(a){for(var b=0,c="";b<a.length-1;b++)c+="&nbsp;";return c+" "});e.html(a);b.css("height",Math.max(e[0].offsetHeight+10,c)+"px")};b.bind("keyup keydown keypress change",a);a()}}).directive("uploader",function(){return{restrict:"E",scope:{action:"@"},controller:["$scope","Auth",
"Session",function(a,b,d){a.progress=0;a.login=b.isLoggedIn();a.images=[];d.get("files")&&(a.images=JSON.parse(d.get("files")));a.remove=function(b){a.images.splice(b,1);d.set("files",JSON.stringify(a.images))};a.sendFile=function(b){var e=$(b).parents("form");if(""==$(b).val())return!1;e.attr("action",a.action);a.$apply(function(){a.progress=0});e.ajaxSubmit({type:"POST",uploadProgress:function(b,c,d,e){a.$apply(function(){a.progress=e})},error:function(a,b,c,d){e.removeAttr("action")},success:function(f,
g,h,k){$(b).val().split("\\");e.removeAttr("action");a.$apply(function(){if(0<f.images.length)for(var b=0;b<f.images.length;b++)a.images.push(f.images[b]);d.set("files",JSON.stringify(a.images))})}})}}],link:function(a,b,d,c){b.find(".upload").click(function(){b.find('input[type="file"]').click()})},replace:!1,templateUrl:"html/uploader.html"}}).directive("debug",function(){return{restrict:"E",scope:{expression:"=val"},template:"<pre>{{debug(expression)}}</pre>",link:function(a){a.debug=function(a){return angular.toJson(a,
!0)}}}}).directive("imgmap",function(){return{restrict:"A",link:function(a,b,d){a.$watch(d.imgmap,function(a){0<a.latitude&&b.html('<img class="img-responsive" src="//maps.googleapis.com/maps/api/staticmap?center='+a.latitude+","+a.longitude+"&markers="+a.latitude+","+a.longitude+'&zoom=15&size=640x320&sensor=false" alt="" />')})}}}).directive("carousel",[function(){return{restrict:"EA",transclude:!0,replace:!0,require:"carousel",templateUrl:"html/carousel.html",scope:{slides:"=",rent:"=",price:"="},
controller:["$scope",function(a){a.direction="left";a.currentIndex=0;a.setSlide=function(b){a.currentIndex=b};a.isSlide=function(b){return a.currentIndex===b};a.prev=function(){a.direction="left";a.currentIndex=a.currentIndex<a.slides.length-1?++a.currentIndex:0};a.next=function(){a.direction="right";a.currentIndex=0<a.currentIndex?--a.currentIndex:a.slides.length-1}}]}}]).directive("dropdownToggle",["$document","$location",function(a,b){var d=null,c=angular.noop;return{restrict:"CA",link:function(b,
f,g){b.$watch("$location.path",function(){c()});f.parent().bind("click",function(){c()});f.bind("click",function(b){var e=f===d;b.preventDefault();b.stopPropagation();d&&c();e||f.hasClass("disabled")||f.prop("disabled")||(f.parent().addClass("open"),d=f,c=function(b){b&&(b.preventDefault(),b.stopPropagation());a.unbind("click",c);f.parent().removeClass("open");c=angular.noop;d=null},a.bind("click",c))})}}}]).directive("lazyBackground",["$document","$parse",function(a,b){return{restrict:"A",link:function(d,
c,e){function f(a){g&&(a.html(""),a.append(g),a.css({"background-image":null}))}var g=null;angular.isDefined(e.lazyLoader)&&(g=angular.element(a[0].querySelector(e.lazyLoader)).clone());var h=b(e.lazyBackground);d.$watch(h,function(b){f(c);b=h(d);var l=a[0].createElement("img");l.onload=function(){g&&g.remove();angular.isDefined(e.lazyLoadingClass)&&c.removeClass(e.lazyLoadingClass);angular.isDefined(e.lazyLoadedClass)&&c.addClass(e.lazyLoadedClass);c.css({"background-image":"url("+this.src+")"})};
l.onerror=function(){};l.src=b})}}}]).directive("tiAutosize",function(){return{restrict:"A",require:"ngModel",link:function(a,b,d,c){var e,f;e=angular.element('<span class="input"></span>');e.css("display","none").css("visibility","hidden").css("width","auto").css("white-space","pre");b.parent().append(e);f=function(a){var c=a,f;angular.isString(c)&&0===c.length&&(c=d.placeholder);c&&(e.text(c),e.css("display",""),f=e.prop("offsetWidth"),e.css("display","none"));b.css("width",f?f+3+"px":"213px");
return a};c.$parsers.unshift(f);c.$formatters.unshift(f);d.$observe("placeholder",function(a){c.$modelValue||f(a)})}}});
angular.module("App.filters",[]).filter("unsafe",["$sce",function(a){return function(b){return a.trustAsHtml(b)}}]).filter("fixbr",function(){return function(a){if(a)return a.replace(/&lt;br(.*?)\/&gt;/g,"<br />")}}).filter("thumb",function(){return function(a){return-1<["jpg","jpeg","png","gif","bmp"].indexOf(/(?:\.([^.]+))?$/.exec(a)[1])?a:"attach.png"}}).filter("bbcode",function(){return function(a){for(var b=[/\[b\](.*?)\[\/b\]/gi,/\[i\](.*?)\[\/i\]/gi,/\[u\](.*?)\[\/u\]/gi,/\[3d\](.*?)\[\/3d\]/gi],
d=["<strong>$1</strong>","<em>$1</em>",'<span style="text-decoration: underline;">$1</span>','<iframe src="$1" width="100%" class="frame" marginheight="0" frameborder="0" allowfullscreen></iframe>'],c=0;c<b.length;c++)a=a.replace(b[c],d[c]);return a}}).filter("vndong",function(){return function(a){var b=parseInt(a);if(b){for(var b=parseInt(a),d=[" \u0111\u1ed3ng"," ngh\u00ecn \u0111\u1ed3ng"," tri\u1ec7u \u0111\u1ed3ng"," t\u1ef7 \u0111\u1ed3ng"," ngh\u00ecn t\u1ef7 \u0111\u1ed3ng"],c=0;1E3<=b;c++)b/=
1E3;return c>=d.length?"S\u1ed1 ti\u1ec1n qu\u00e1 l\u1edbn":b?(b=Math.round(100*b)/100,"~ "+b.toString().replace(".",",")+d[c]):a}return"S\u1ed1 ti\u1ec1n kh\u00f4ng h\u1ee3p l\u1ec7"}}).filter("pricify",function(){return function(a){a=parseInt(a);if(1E3>a)return a.toString();if(1E5>a)return a=Math.round(a/1E3),a.toString()+".000";if(1E6>a||1E9>a)return a=Math.round(a/1E6*100)/100,a.toString()+"<small>TR</small>";a=Math.round(a/1E9*100)/100;return a.toString()+"<small>T\u1ef6</small>"}}).filter("rentify",
function(){return function(a){a=parseInt(a);if(1E3>a)return a.toString();if(1E5>a)return a=Math.round(a/1E3),a.toString()+".000/th";if(1E6>a||1E9>a)return a=Math.round(a/1E6*100)/100,a.toString()+"<small>TR</small>/th";a=Math.round(a/1E9*100)/100;return a.toString()+"<small>T\u1ef6</small>/th"}}).filter("characters",function(){return function(a,b,d){if(isNaN(b))return a;if(0>=b)return"";if(a&&a.length>=b){a=a.substring(0,b);if(d)for(;" "==a.charAt(a.length-1);)a=a.substr(0,a.length-1);else b=a.lastIndexOf(" "),
-1!==b&&(a=a.substr(0,b));return a+"..."}return a}}).filter("words",function(){return function(a,b){if(isNaN(b))return a;if(0>=b)return"";if(a){var d=a.split(/\s+/);d.length>b&&(a=d.slice(0,b).join(" ")+"...")}return a}}).filter("tel",function(){return function(a){if(!a)return"";var b=a.toString().trim().replace(/[^\d]/g,"");if(b.match(/[^0-9]/))return a;var d;switch(b.length){case 10:a="";d=b.slice(0,3);b=b.slice(3);break;case 11:"84"==b.slice(0,2)?(a="+84",d=b.slice(0,5).slice(2),b=b.slice(5)):
(a="",d=b.slice(0,4),b=b.slice(4));break;case 12:a="+"+b.slice(0,2);d=b.slice(0,5).slice(2);b=b.slice(5);break;default:return a}b=b.slice(0,3)+"-"+b.slice(3);return(a+" ("+d+") "+b).trim()}});
angular.module("App.controllers",[]).controller("ShareCtrl",["$scope","$http","$timeout","$location","$rootScope","Session","Flash","Domain",function(a,b,d,c,e,f,g,h){a.steps=["one","two"];a.step=0;a.page=0;a.form={};a.results=[];a.tags=[];a.login=e.isLogin;a.isFirstStep=function(){return 0===a.step};a.isLastStep=function(){return a.step===a.steps.length-1};a.CurrentStep=function(){return a.steps[a.step]};a.Label=function(){return a.isLastStep()?"\u0110\u0103ng":"Ti\u1ebfp theo"};a.Previous=function(){a.step-=
a.isFirstStep()?0:1};a.Next=function(){a.isLastStep()?a.submit():(a.step+=1,1==a.step&&a.Tags())};a.submit=function(){if("undefined"!=typeof a.form.message){if(e.isLogin)return a.form.images=JSON.parse(f.get("files")),b.post(h+"/api/message/create",a.form).success(function(a){g.show({type:"success",msg:"\u0110\u0103ng tin th\u00e0nh c\u00f4ng."});d(function(){c.path("/c/"+a.message.id+".html")},500);f.unset("files")}).error(function(a){g.show({type:"danger",msg:a.flash})});alert("B\u1ea1n ch\u01b0a \u0111\u0103ng nh\u1eadp, vui l\u00f2ng \u0111\u0103ng nh\u1eadp.")}else a.step=
0,g.show({type:"danger",msg:"B\u1ea1n vui l\u00f2ng nh\u1eadp n\u1ed9i dung \u0111\u1ec3 chia s\u1ebb."})};a.Tags=function(){if("undefined"!=typeof a.form.message){var c=a.form.message;a.page+=1;3<c.length&&b.post(h+"/api/message/tags",{content:c,group:!0,page:a.page}).success(function(b){a.tags=b.tags})}};a.toggle=function(b){var c=a.form.tag.indexOf(b);-1<c?a.form.tag.splice(c,1):a.form.tag.push(b)}}]).controller("SaleCtrl",["$scope","$timeout","$log","$http","$location","$rootScope","Flash","Session",
"Domain",function(a,b,d,c,e,f,g,h,k){a.login=f.isLogin;a.steps="one two three four five six".split(" ");a.step=0;a.page=0;a.busy=!1;a.form={};a.results=[];a.tags=[];a.isFirstStep=function(){return 0===a.step};a.isLastStep=function(){return a.step===a.steps.length-1};a.CurrentStep=function(){return a.steps[a.step]};a.Label=function(){return a.isLastStep()?"\u0110\u0103ng tin":"Ti\u1ebfp theo"};a.Previous=function(){a.step-=a.isFirstStep()?0:1};a.Next=function(){a.isLastStep()?a.submit():(a.step+=1,
1==a.step&&(a.Tags(),a.form.images=JSON.parse(h.get("files"))))};a.center={latitude:10.823099,longitude:106.629664};a.zoom=15;a.markers=[];a.markerLat=null;a.markerLng=null;a.addMarker=function(){a.markers.push({latitude:parseFloat(a.markerLat),longitude:parseFloat(a.markerLng)});a.markerLat=null;a.markerLng=null};a.geolocationAvailable=navigator.geolocation?!0:!1;a.checkin=function(){a.geolocationAvailable&&navigator.geolocation.getCurrentPosition(function(b){a.center={latitude:b.coords.latitude,
longitude:b.coords.longitude};a.position={coords:a.center};a.markers=[];a.markers.push(a.center);a.markerLat=null;a.markerLng=null;a.$apply()},function(){})};a.gmap=function(b){a.center={latitude:b.map[0],longitude:b.map[1]};a.form.local=a.form.local1=b.local;if(0<b.tag.length)for(var c=0;c<b.tag.length;c++)a.form.tag.push(b.tag[c]);b.check&&(a.markers=[],a.markers.push(a.center))};a.Tags=function(){if("undefined"!=typeof a.form.message){var b=a.form.message;a.page+=1;3<b.length&&c.post(k+"/api/message/tags",
{content:b,page:a.page}).success(function(b){if(0<b.tags.length)for(var c=0;c<b.tags.length;c++)a.tags.push(b.tags[c]);b.price&&!a.form.price&&(a.form.price=b.price)})}};a.toggle=function(b){var c=a.form.tag.indexOf(b);-1<c?a.form.tag.splice(c,1):a.form.tag.push(b)};a.suggests=function(){if("undefined"!=typeof a.form.local1){var b=a.form.local1;!a.busy&&1<b.length?(a.busy=!0,c.post(k+"/api/address",{address:b}).success(function(b){a.results=b.results;a.busy=!1}).error(function(){a.busy=!1})):a.results=
[]}};a.capslock=function(a){var b=0;for(i=0;i<a.length;i++)65<=a[i].charCodeAt(a[i])&&90>=a[i].charCodeAt(a[i])&&b++;return 15>b/a.length*100};a.submit=function(){a.markers.length&&(a.form.map=a.markers[0].latitude+", "+a.markers[0].longitude);if("undefined"!=typeof a.form.message&&20<=a.form.message.length){if(a.capslock(a.form.message))return c.post(k+"/api/message/create",a.form).success(function(a){g.show({type:"success",msg:"B\u1ea1n \u0111\u00e3 \u0111\u0103ng tin th\u00e0nh c\u00f4ng."});b(function(){e.path("/p/"+
a.message.id+".html")},500);h.unset("files")}).error(function(b){a.step=0;g.show({type:"danger",msg:b.flash})});g.show({type:"danger",msg:"N\u1ed9i dung qu\u00e1 nhi\u1ec1u k\u00fd t\u1ef1 vi\u1ebft hoa."})}else g.show({type:"danger",msg:"N\u1ed9i dung qu\u00e1 ng\u1eafn, \u00edt nh\u1ea5t 20 k\u00fd t\u1ef1."});a.step=0}}]).controller("WelcomeCtrl",["$scope",function(a){}]).controller("GroupCtrl",["$scope","$timeout","$log","$http","$location","$rootScope","Flash","Domain",function(a,b,d,c,e,f,g,
h){a.login=f.isLogin;a.steps="one two three four five six seven".split(" ");a.step=0;a.form={};a.results=[];a.tags=[];a.isFirstStep=function(){return 0===a.step};a.isLastStep=function(){return a.step===a.steps.length-1};a.CurrentStep=function(){return a.steps[a.step]};a.Label=function(){return a.isLastStep()?"T\u1ea1o \u0111\u1ecba danh":"Ti\u1ebfp theo"};a.Previous=function(){a.step-=a.isFirstStep()?0:1};a.Next=function(){a.isLastStep()?a.submit():(1===a.step&&a.Exist(),a.step+=1)};a.center={latitude:10.823099,
longitude:106.629664};a.zoom=15;a.markers=[];a.markerLat=null;a.markerLng=null;a.addMarker=function(){a.markers.push({latitude:parseFloat(a.markerLat),longitude:parseFloat(a.markerLng)});a.markerLat=null;a.markerLng=null};a.geolocationAvailable=navigator.geolocation?!0:!1;a.checkin=function(){a.geolocationAvailable&&navigator.geolocation.getCurrentPosition(function(b){a.center={latitude:b.coords.latitude,longitude:b.coords.longitude};a.position={coords:a.center};a.markers=[];a.markers.push(a.center);
a.$apply()},function(){})};a.gmap=function(b){a.center={latitude:b.map[0],longitude:b.map[1]};a.form.local=a.form.local1=b.local};a.Tags=function(b){return c.post(h+"/api/message/tags",{content:b}).success(function(b){a.tags=b.tags})};a.Exist=function(){return c.post(h+"/api/group/tags",{keyword:a.form.name}).success(function(b){a.items=b.results;a.form.subdomain=b.slug;a.Domain()})};a.Domain=function(){if("undefined"!=typeof a.form.subdomain&&2<a.form.subdomain.length)return c.post(h+"/api/group/domain",
{domain:a.form.subdomain}).success(function(b){a.success=0===b.results.length?!0:!1});a.success=!1};a.toggle=function(b){var c=a.form.tag.indexOf(b);-1<c?a.form.tag.splice(c,1):a.form.tag.push(b)};a.suggests=function(){if("undefined"!=typeof a.form.local1){var b=a.form.local1;!a.busy&&1<b.length?(a.busy=!0,c.post(h+"/api/address",{address:b,group:!0}).success(function(b){a.results=b.results;a.busy=!1}).error(function(){a.busy=!1})):a.results=[]}};a.submit=function(){a.markers.length&&(a.form.map=
a.markers[0].latitude+", "+a.markers[0].longitude);if("undefined"!=typeof a.form.map&&"undefined"!=typeof a.form.local)return c.post(h+"/api/group/create",a.form).success(function(a){g.show({type:"success",msg:"B\u1ea1n \u0111\u00e3 t\u1ea1o \u0111\u1ecba danh th\u00e0nh c\u00f4ng."});b(function(){e.path("/t/"+a.group.slug+".html")},1E3)}).error(function(b){a.step=1;g.show({type:"danger",msg:b.flash})});g.show({type:"danger",msg:"B\u1ea1n c\u1ea7n ph\u1ea3i ch\u1ecdn ph\u01b0\u1eddng x\u00e3, qu\u1eadn huy\u1ec7n ho\u1eb7c t\u1ecda \u0111\u1ed9 cho \u0111\u1ecba danh."});
a.step=1}}]).controller("AgentCtrl",["$scope","$timeout","$log","$http","$location","$rootScope","Flash","Domain",function(a,b,d,c,e,f,g,h){a.login=f.isLogin;a.steps=["one","two"];a.step=0;a.form={};a.results=[];a.isFirstStep=function(){return 0===a.step};a.isLastStep=function(){return a.step===a.steps.length-1};a.CurrentStep=function(){return a.steps[a.step]};a.Label=function(){return a.isLastStep()?"\u0110\u0103ng k\u00fd":"Ti\u1ebfp theo"};a.Previous=function(){a.step-=a.isFirstStep()?0:1};a.Next=
function(){a.isLastStep()?a.submit():a.step+=1};a.Exist=function(){if(2<a.form.username.length)return c.post(h+"/api/user/username",{username:a.form.username}).success(function(b){a.success=0===b.results.length?!0:!1});a.success=!1};a.submit=function(){return c.post(h+"/api/user/agent",a.form).success(function(a){g.show({type:"success",msg:"B\u1ea1n \u0111\u00e3 t\u1ea1o \u0111\u1ecba danh th\u00e0nh c\u00f4ng."});e.path("/")}).error(function(b){a.step=1;g.show({type:"danger",msg:b.flash})})}}]).controller("TagCtrl",
["$scope","$http","$routeParams","TagService","Auth","Domain",function(a,b,d,c,e,f){a.isRealEstate=!0;a.isStatus=!0;a.user=e.user();a.isSwitch=function(b){b&&(a.isStatus||(a.isStatus=!0),a.isRealEstate||(a.isRealEstate=!0));return!b};angular.extend(a,{position:{coords:{latitude:10.823099,longitude:106.629664}},center:{latitude:0,longitude:0},markers:[],zoom:11,longitude:null,latitude:null});b.post(f+"/api/tag",{slug:d.tagId}).success(function(b){a.item=b.data;a.results=new c(a.item.slug);a.stats=
b.stats;a.item.map&&(a.center={latitude:parseFloat(a.item.map[0]),longitude:parseFloat(a.item.map[1])},a.position={coords:{latitude:parseFloat(a.item.map[0]),longitude:parseFloat(a.item.map[1])}},a.markers.push(a.center))}).error(function(b,c){404===c&&(a.item=[])})}]).controller("PostCtrl",["$scope","$http","$routeParams","Auth","Domain",function(a,b,d,c,e){angular.extend(a,{position:{coords:{latitude:10.823099,longitude:106.629664}},center:{latitude:0,longitude:0},markers:[],zoom:15,longitude:null,
latitude:null});a.login=c.isLoggedIn();a.user=c.user();a.submit=function(d){if(c.isLoggedIn())return b.post(e+"/api/comment/create",{msg_id:d,comment:a.form.comment}).success(function(b){a.item.comments.push(b);a.form={}}).error(function(a){alert("B\u1ea1n ph\u1ea3i \u0111\u0103ng nh\u1eadp \u0111\u1ec3 s\u1eed d\u1ee5ng ch\u1ee9c n\u0103ng n\u00e0y.")});alert("B\u1ea1n ph\u1ea3i \u0111\u0103ng nh\u1eadp \u0111\u1ec3 s\u1eed d\u1ee5ng ch\u1ee9c n\u0103ng n\u00e0y.")};b.post(e+"/api/message/read",
{id:d.postId}).success(function(b){a.item=b;a.item.meta.map&&(a.center={latitude:parseFloat(a.item.meta.map[0]),longitude:parseFloat(a.item.meta.map[1])},a.position={coords:{latitude:parseFloat(a.item.meta.map[0]),longitude:parseFloat(a.item.meta.map[1])}},a.markers.push(a.center))}).error(function(b,c){404===c&&(a.item=[])})}]).controller("MapCtrl",["$scope",function(a){}]).controller("TypeaheadCtrl",["$scope","$http","$timeout","TagService","Domain",function(a,b,d,c,e){a.results=[];a.isRealEstate=
!0;a.isStatus=!0;a.isFirst=!0;a.isFollow=!0;a.busy=!1;a.tags=[];angular.extend(a,{position:{coords:{latitude:10.823099,longitude:106.629664}},center:{latitude:0,longitude:0},markers:[],zoom:11,longitude:null,latitude:null});a.isSwitch=function(b){b&&(a.isStatus||(a.isStatus=!0),a.isRealEstate||(a.isRealEstate=!0));return!b};a.focus=function(){a.isFollow=!0};a.remove=function(b){a.tags.splice(b,1);a.Tags();1>a.tags.length&&(a.isFollow=!0,a.isFirst=!0,a.follows=a._follows)};a.add=function(b){"undefined"!=
typeof b&&(a.tags.push(b),a.isFollow=!1,a.isFirst=!1,a.newTag="",a.Tags());1<a.tags.length&&(a.item=[])};a.search=function(){"undefined"!=typeof a.keyword?d(function(){a.results=new c(a.keyword)},1E3):a.results=[]};a.suggests=function(c){0<c.length?(a.busy=!0,b.post(e+"/api/search/typeahead",{keyword:c}).then(function(b){a.follows=b.data;a.isFollow=!0;a.isFirst=!1;a.busy=!1})):(a.isFollow=!0,a.isFirst=!0,b.post(e+"/api/search/follows").success(function(b){a.follows=b}))};b.post(e+"/api/search/follows").success(function(b){a.follows=
b;a._follows=b});a.Tags=function(){a.item=[];a.results=[];a.stats=[];a.tags.length?(a.results=new c(a.tags),1==a.tags.length&&b.post(e+"/api/search/nero",{keyword:a.tags}).success(function(b){a.isFollow=!1;a.item=b.data;a.stats=b.stats;a.item.map&&(a.center={latitude:parseFloat(a.item.map[0]),longitude:parseFloat(a.item.map[1])},a.position={coords:{latitude:parseFloat(a.item.map[0]),longitude:parseFloat(a.item.map[1])}},a.markers.push(a.center))})):a.isFirst=!0}}]).controller("ClassifiedCtrl",["$scope",
"$http","$location","SearchService","Auth","Domain",function(a,b,d,c,e,f){a.isRealEstate=!0;a.isStatus=!0;a.user=e.user();a.isSwitch=function(b){b&&(a.isStatus||(a.isStatus=!0),a.isRealEstate||(a.isRealEstate=!0));return!b};a.results=new c;b.post(f+"/api/stats").success(function(b){a.stats=b.stats})}]).controller("ProfileCtrl",["$scope","$http","$routeParams","SearchService","Auth","Domain",function(a,b,d,c,e,f){a.myInterval=6E4;a.isRealEstate=!0;a.isStatus=!0;a.form={};a.user=e.user();b.post(f+"/profile.html",
{username:d.profileId}).success(function(b){a.user=b.user;a.slides=b.slides;a.stats=b.stats;a.results=new c({uid:b.user.idu})});a.isSwitch=function(b){b&&(a.isStatus||(a.isStatus=!0),a.isRealEstate||(a.isRealEstate=!0));return!b}}]).controller("SliderCtrl",["$scope","$interval","$http","Domain",function(a,b,d,c){a.slides=[];d.post(c+"/api/slider").success(function(b){a.slides=b});a.direction="left";a.currentIndex=0;a.setSlide=function(b){a.currentIndex=b};a.isSlide=function(b){return a.currentIndex===
b};a.prev=function(){a.direction="left";a.currentIndex=a.currentIndex<a.slides.length-1?++a.currentIndex:0};a.next=function(){a.direction="right";a.currentIndex=0<a.currentIndex?--a.currentIndex:a.slides.length-1};b(function(){a.currentIndex=a.currentIndex<a.slides.length-1?++a.currentIndex:0},5E3)}]).controller("ContactCtrl",["$scope","$http","$location","$timeout","Flash","Domain",function(a,b,d,c,e,f){a.lastForm={};a.form={};a.disabled=!1;a.submit=function(g){a.lastForm=angular.copy(g);b.post(f+
"/api/contact",{fullname:a.form.fullname,email:a.form.email,select:a.form.select,message:a.form.message}).success(function(b){a.disabled=!0;c(function(){d.path("/index.html")},5E3);e.show({type:"success",msg:b.flash})}).error(function(a){e.show({type:"danger",msg:a.flash})})};a.reset=function(){a.form=angular.copy(a.lastForm)}}]).controller("FollowCtrl",["$scope","$http","Domain",function(a,b,d){b.post(d+"/api/follows").success(function(b){a.follows=b})}]).controller("CommentsCtrl",["$scope","$http",
"$routeParams","Auth","Flash","Domain",function(a,b,d,c,e,f){a.form={};a.login=c.isLoggedIn();a.user=c.user();angular.extend(a,{position:{coords:{latitude:10.823099,longitude:106.629664}},center:{latitude:0,longitude:0},markers:[],zoom:17,longitude:null,latitude:null});a.submit=function(d){if(c.isLoggedIn())return b.post("/api/comment/create",{msg_id:d,comment:a.form.comment}).success(function(b){a.item.comments.push(b);a.form={}}).error(function(a){alert("B\u1ea1n ph\u1ea3i \u0111\u0103ng nh\u1eadp \u0111\u1ec3 s\u1eed d\u1ee5ng ch\u1ee9c n\u0103ng n\u00e0y.")});
alert("B\u1ea1n ph\u1ea3i \u0111\u0103ng nh\u1eadp \u0111\u1ec3 s\u1eed d\u1ee5ng ch\u1ee9c n\u0103ng n\u00e0y.")};b.post(f+"/api/message/read",{id:d.commentId}).success(function(b){a.item=b;a.item.meta.map&&(a.center={latitude:parseFloat(a.item.meta.map[0]),longitude:parseFloat(a.item.meta.map[1])},a.position={coords:{latitude:parseFloat(a.item.meta.map[0]),longitude:parseFloat(a.item.meta.map[1])}},a.markers.push(a.center))}).error(function(b,c){404===c&&(a.item=[])})}]).controller("LoginCtrl",
["$scope","$location","$http","$filter","$rootScope","Auth","Flash","Domain",function(a,b,d,c,e,f,g,h){a.steps=["one","two","three","four"];a.step=0;a.credentials={user:"",password:""};a.isFirstStep=function(){return 0===a.step};a.isLastStep=function(){return a.step===a.steps.length-1};a.CurrentStep=function(){return a.steps[a.step]};a.NextLabel=function(){return a.isLastStep()?"\u0110\u0103ng nh\u1eadp":a.isFirstStep()?"Ti\u1ebfp t\u1ee5c":"X\u00e1c nh\u1eadn"};a.Previous=function(){a.step=0};a.Next=
function(){a.isFirstStep()?a.email_or_phone():3<a.credentials.password.length?a.login():g.show({type:"danger",msg:"M\u1eadt kh\u1ea9u/M\u00e3 x\u00e1c nh\u1eadn qu\u00e1 ng\u1eafn."})};a.email_or_phone=function(){d.post(h+"/api/user/status",{user:a.credentials.user}).success(function(b){a.step=a.steps.length-1;a.phone="phone"==b.user;a.email="email"==b.user;b.flash&&g.show({type:"info",msg:b.flash})}).error(function(b,c){404==c?("phone"==b.user?a.step=1:"email"==b.user&&(a.step=2),b.flash&&g.show({type:"danger",
msg:b.flash})):(a.step=0,g.show({type:"danger",msg:"Email ho\u1eb7c s\u1ed1 \u0111i\u1ec7n tho\u1ea1i kh\u00f4ng h\u1ee3p l\u1ec7."}))})};a.resetpw=function(){f.sendmail(a.credentials).error(function(){a.step=0})};a.login=function(){f.login(a.credentials).success(function(a){a.user.otp?b.path("/newpassword.html"):e.isPath?(b.path(e.isPath),e.isPath=""):b.path("/index.html")}).error(function(){a.step=0})};a.$watch("credentials.user",function(){a.credentials.user=c("tel")(a.credentials.user)})}]).controller("AccountCtrl",
["$scope","$http","$location","$filter","Auth","Flash","Domain",function(a,b,d,c,e,f,g){a.phone=!1;a.email=!1;a.name=!1;a.passwd=!1;a.user=e.user();a.$watch("form.phone",function(){a.form.phone=c("tel")(a.form.phone)});a.verify=function(){return b.post(g+"/api/user/verify",a.form).success(function(b){f.show({type:"success",msg:b.flash});b.phone&&(a.phone=!0,a.email=!1);b.email&&(a.phone=!1,a.email=!0)}).error(function(a){f.show({type:"danger",msg:a.flash})})};a.confirm=function(){return b.post(g+
"/api/user/confirm",a.form).success(function(a){f.show({type:"success",msg:a.flash});e.update(a.user);d.path("/index.html")}).error(function(a){f.show({type:"danger",msg:a.flash})})};a.submit=function(){if(e.isLoggedIn())return b.post(g+"/api/user/update",a.form).success(function(b){f.show({type:"success",msg:b.flash});e.update(b.user);a.user=e.user();a.name=!1}).error(function(b){f.show({type:"danger",msg:b.flash});a.user=e.user()});f.show({type:"danger",msg:"B\u1ea1n ch\u01b0a \u0111\u0103ng nh\u1eadp, vui l\u00f2ng \u0111\u0103ng nh\u1eadp."})};
a.password=function(){if(e.isLoggedIn()){if("undefined"!=typeof a.form.password&&6<=a.form.password.length)return b.post(g+"/api/user/update",a.form).success(function(b){f.show({type:"success",msg:b.flash});e.update(b.user);a.passwd=!1}).error(function(a){f.show({type:"danger",msg:a.flash})});f.show({type:"danger",msg:"M\u1eadt kh\u1ea9u \u00edt nh\u1ea5t 6 k\u00fd t\u1ef1."})}else f.show({type:"danger",msg:"B\u1ea1n ch\u01b0a \u0111\u0103ng nh\u1eadp, vui l\u00f2ng \u0111\u0103ng nh\u1eadp."})}}]).controller("NewPasswordCtrl",
["$scope","$http","$location","Auth","Flash","Domain",function(a,b,d,c,e,f){a.update=function(){if(c.isLoggedIn()){if("undefined"!=typeof a.form.password&&6<=a.form.password.length)return b.post(f+"/api/user/update",a.form).success(function(a){c.update(a.user);d.path("/index.html");e.show({type:"success",msg:a.flash})}).error(function(a){e.show({type:"danger",msg:a.flash})});e.show({type:"danger",msg:"M\u1eadt kh\u1ea9u \u00edt nh\u1ea5t 6 k\u00fd t\u1ef1."})}else e.show({type:"danger",msg:"B\u1ea1n ch\u01b0a \u0111\u0103ng nh\u1eadp, vui l\u00f2ng \u0111\u0103ng nh\u1eadp."})}}]).controller("CameraCtrl",
["$scope","$location","Domain",function(a,b,d){a.data={};var c,e;document.addEventListener("deviceready",function(){navigator.camera&&(c=navigator.camera.PictureSourceType,e=navigator.camera.DestinationType)},!1);a.takePicture=function(){var b={quality:85,destinationType:e,sourceType:c,encodingType:0};navigator.camera&&navigator.camera.getPicture(function(b){a.mypicture=b},function(a){},b)};a.update=function(b){function c(a){}function e(a){}a.data.uploadurl&&a.mypicture&&(b=new FileUploadOptions,
b.fileKey="file",b.fileName=a.mypicture.substr(a.mypicture.lastIndexOf("/")+1),b.mimeType="image/jpeg",b.params={},(new FileTransfer).upload(a.mypicture,encodeURI(d+"/api/upload"),c,e,b))}}]).animation(".slide-animation",function(){return{addClass:function(a,b,d){var c=a.scope();"ng-hide"==b?(b=a.parent().width(),"right"!==c.direction&&(b=-b),TweenMax.to(a,0.5,{left:b,onComplete:d})):d()},removeClass:function(a,b,d){var c=a.scope();"ng-hide"==b?(a.removeClass("ng-hide"),b=a.parent().width(),"right"===
c.direction&&(b=-b),TweenMax.set(a,{left:b}),TweenMax.to(a,0.5,{left:0,onComplete:d})):d()}}});
